- [数据库SQL学习](#数据库SQL学习)
  - [存储引擎myisam 和 innodb](#存储引擎myisam 和 innodb)
  - [mysql索引](#mysql索引)
  - [事务](#事务)
  - [大表优化](#大表优化)
  - [数据库SQL学习](#数据库SQL学习)



# 数据库SQL学习
## 存储引擎myisam 和 innodb
> myisam是mysql 5.5之前的默认引擎，后来被Innodb代替为默认引擎。

> 当你不需要处理高并发、不要求事务处理，不讲求事务崩溃后的数据安全问题那么就用myisam,它处理速度快。innnodb：支持事务、支持行级锁，有处理事务崩溃的ACID

## mysql索引
> mysql 查询多为单条查询时用哈希索引，否则用b+树索引。

> myisam的b+树data域存储地址，地址里面存值，得去地址找值这叫“非聚簇索引”，地址散，值散，谈何聚；
innodb的data域存储主键的值（key），叶子结点才存值，叶子结点有所有的值卫星数据这叫聚簇索引、主索引，
data域那些叫辅助索引，查询时查到辅助索引再跳到主索引里找值。

## 事务
> 不可重复读强调的是同一个事务的两次相同读操作，因为中途被另一事物的写给中断了，导致了两次读的结果不一样。确实感觉破坏了事务的原子性

> 前面说到mysql 的 innodb存储引擎支持行级锁，行级锁有三：Record/Gap/Next key Lock;mysql默认事务隔离级别是可重复读，就是因为用了Next key lock算法
弥补了幻读的缺陷。这个算法综合了前两种算法，实现了可锁，还锁了一个范围，如给 8 for update时索引范围可能是（5,8]，（8,11]，那么5~11的插入就会被阻塞。

## 大表优化
> 限制只能看一个月的订单；读写分离？；垂直分区，拆成多个表；水平分区，把列拆分，可以存很多数据，但是这样分片事务操作会有逻辑上的复杂。
